<div class="extraction-container">
  <h2>Contract Extraction</h2>
  
  @if (loading()) {
    <div class="loading">
      Extracting contract information... This may take a moment.
    </div>
  }
  
  @if (hasError()) {
    <div class="error">
      {{ error() }}
    </div>
  }
  
  <!-- Tabs -->
  <div class="tabs">
    <button 
      class="tab-button" 
      [class.active]="activeTab() === 'default'"
      (click)="onTabChange('default')">
      Default Contract
    </button>
    <button 
      class="tab-button" 
      [class.active]="activeTab() === 'text'"
      (click)="onTabChange('text')">
      Text Input
    </button>
    <button 
      class="tab-button" 
      [class.active]="activeTab() === 'file'"
      (click)="onTabChange('file')">
      File Upload
    </button>
  </div>
  
  <!-- Tab Content -->
  <div class="tab-content">
    <!-- Default Contract Tab -->
    @if (activeTab() === 'default') {
      <div class="tab-panel">
        <h3>Extract from Default Contract</h3>
        <p>This will extract information from the sample contract file included with the application.</p>
        <button (click)="onExtractDefault()" [disabled]="loading()" class="btn btn-primary">
          Extract from Default Contract
        </button>
      </div>
    }
    
    <!-- Text Input Tab -->
    @if (activeTab() === 'text') {
      <div class="tab-panel">
        <h3>Extract from Contract Text</h3>
        <div class="form-group">
          <label for="contractText">Contract Text:</label>
          <textarea 
          id="contractText"
          [ngModel]="contractText()"
          (ngModelChange)="contractText.set($event)"
          placeholder="Paste your contract text here..."
          rows="10"
          class="form-control">
        </textarea>
      </div>
      <button 
        (click)="onExtractFromText()" 
        [disabled]="loading() || !isValidText()" 
        class="btn btn-primary">
        Extract from Text
      </button>
    </div>
    }
    
    <!-- File Upload Tab -->
    @if (activeTab() === 'file') {
      <div class="tab-panel">
        <h3>Extract from File</h3>
        <div class="form-group">
          <label for="fileInput">Select Contract File:</label>
          <input 
            type="file" 
            id="fileInput"
            (change)="onFileSelected($event)"
            accept=".pdf,.txt,.doc,.docx"
            class="form-control file-input">
          <small class="file-help">Supported formats: PDF, TXT, DOC, DOCX</small>
        </div>
        @if (selectedFile()) {
          <div class="selected-file">
            Selected: {{ selectedFile()!.name }} ({{ (selectedFile()!.size / 1024 / 1024).toFixed(2) }} MB)
          </div>
        }
        <button 
          (click)="onExtractFromFile()" 
          [disabled]="loading() || !isValidFile()" 
          class="btn btn-primary">
          Extract from File
        </button>
      </div>
    }
  
  <!-- Results -->
  @if (hasResults()) {
    <div class="results-section">
      <h3>Extraction Results</h3>
      
      <div class="results-grid">
        <!-- Basic Information -->
        <div class="result-card">
          <h4>Basic Information</h4>
          <div class="result-item">
            <label>Contract Type:</label>
            <span>{{ result()?.contractType || 'Not specified' }}</span>
          </div>
          <div class="result-item">
            <label>Contract Value:</label>
            <span>{{ formatValue(result()?.contractValue ?? null) }}</span>
          </div>
          <div class="result-item">
            <label>Effective Date:</label>
            <span>{{ formatDate(result()?.effectiveDate ?? null) }}</span>
          </div>
          <div class="result-item">
            <label>Expiration Date:</label>
            <span>{{ formatDate(result()?.expirationDate ?? null) }}</span>
          </div>
          <div class="result-item">
            <label>Governing Law:</label>
            <span>{{ result()?.governingLaw || 'Not specified' }}</span>
          </div>
          <div class="result-item">
            <label>Processing Time:</label>
            <span>{{ result()?.processingTime }}</span>
          </div>
        </div>
      
      <!-- Parties -->
      <div class="result-card">
        <h4>Parties</h4>
        @if (result()?.parties && result()!.parties.length > 0) {
          @for (party of result()!.parties; track party) {
            <div class="party-item">
              {{ party }}
            </div>
          }
        } @else {
          <div class="no-data">No parties identified</div>
        }
      </div>
      
      <!-- Key Terms -->
      <div class="result-card">
        <h4>Key Terms</h4>
        @if (result()?.keyTerms && result()!.keyTerms.length > 0) {
          @for (term of result()!.keyTerms; track term) {
            <div class="term-item">
              ‚Ä¢ {{ term }}
            </div>
          }
        } @else {
          <div class="no-data">No key terms identified</div>
        }
      </div>
      
      <!-- Risks -->
      <div class="result-card">
        <h4>Identified Risks</h4>
        @if (result()?.risks && result()!.risks.length > 0) {
          @for (risk of result()!.risks; track risk) {
            <div class="risk-item">
              ‚ö†Ô∏è {{ risk }}
            </div>
          }
        } @else {
          <div class="no-data">No risks identified</div>
        }
      </div>
      
      <!-- Recommendations -->
      <div class="result-card">
        <h4>Recommendations</h4>
        @if (result()?.recommendations && result()!.recommendations.length > 0) {
          @for (recommendation of result()!.recommendations; track recommendation) {
            <div class="recommendation-item">
              üí° {{ recommendation }}
            </div>
          }
        } @else {
          <div class="no-data">No recommendations provided</div>
        }
      </div>
      
      <!-- Extracted Text -->
      <div class="result-card full-width">
        <h4>Extracted Text</h4>
        <div class="extracted-text">
          {{ result()?.extractedText || 'No text extracted' }}
        </div>
      </div>
      </div>
    </div>
  }
